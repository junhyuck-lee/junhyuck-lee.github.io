<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Elliott Wave — 심플 크립토 분석</title>
  <meta name="description" content="BTC/ETH/SOL 심플 차트와 메모로 관리하는 가상화폐 분석 페이지" />
  <style>
    :root { --bg:#0b0f14; --card:#121821; --txt:#e8eef6; --muted:#8aa0b2; --accent:#3aa0ff; }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--txt);font-family:system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,sans-serif}
    header{padding:16px 20px;border-bottom:1px solid #1f2a36;display:flex;gap:12px;align-items:center;flex-wrap:wrap}
    .logo{font-weight:800;font-size:18px}
    .pill{background:#0f1520;border:1px solid #203041;color:var(--muted);padding:6px 10px;border-radius:999px}
    .wrap{max-width:1100px;margin:0 auto;padding:16px}
    .tabs{display:flex;gap:8px;flex-wrap:wrap}
    .tab{cursor:pointer;padding:8px 12px;border-radius:10px;background:#0f1520;border:1px solid #203041;color:var(--muted)}
    .tab.active{color:#fff;border-color:var(--accent);box-shadow:0 0 0 1px #1b3a55 inset}
    .grid{display:grid;grid-template-columns:1.5fr 1fr;gap:12px;margin-top:12px}
    @media (max-width:900px){.grid{grid-template-columns:1fr}}
    .card{background:var(--card);border:1px solid #1f2a36;border-radius:14px;overflow:hidden}
    .card h3{margin:0;padding:12px 14px;border-bottom:1px solid #1f2a36;font-size:14px;color:#bcd0df}
    .pad{padding:12px}
    textarea{width:100%;min-height:220px;background:#0f1520;border:1px solid #203041;border-radius:10px;color:var(--txt);padding:10px;font:inherit;resize:vertical}
    .row{display:flex;gap:8px;align-items:center;justify-content:space-between}
    .btn{cursor:pointer;background:#0f1520;border:1px solid #203041;color:#cfe6ff;padding:8px 12px;border-radius:10px}
    .btn:hover{border-color:#2b4b67}
    footer{opacity:.7;text-align:center;padding:18px;font-size:12px}
    .note{color:var(--muted);font-size:12px}
  </style>
</head>
<body>
  <header>
    <div class="logo">📈 Elliott Wave</div>
    <div class="pill">심플 크립토 분석</div>
  </header>

  <!-- 상단 티커 (선택 사항: 필요 없으면 이 전체 섹션 삭제) -->
  <div class="wrap">
    <div class="card">
      <div class="pad" style="padding:0">
        <div class="tradingview-widget-container">
          <div class="tradingview-widget-container__widget" id="ticker-tape"></div>
        </div>
      </div>
    </div>

    <!-- 심볼 탭 -->
    <div class="row" style="margin-top:12px">
      <div class="tabs" id="symbol-tabs">
        <div class="tab active" data-symbol="BINANCE:BTCUSDT">BTC</div>
        <div class="tab" data-symbol="BINANCE:ETHUSDT">ETH</div>
        <div class="tab" data-symbol="BINANCE:SOLUSDT">SOL</div>
      </div>
      <div class="note">탭을 눌러 심볼을 바꾸세요 · BINANCE 선호(스팟/USDT)</div>
    </div>

    <!-- 차트 + 메모 -->
    <div class="grid">
      <div class="card">
        <h3 id="chart-title">차트 · BTCUSDT</h3>
        <div id="tv-chart" style="height:520px"></div>
      </div>

      <div class="card">
        <h3>나의 분석 메모</h3>
        <div class="pad">
          <div class="row" style="margin-bottom:8px">
            <span class="note">엘리엇 파동 카운트, 지지/저항, 목표가, 무효화 레벨 등을 적어두세요.</span>
            <button class="btn" id="save-btn">저장</button>
          </div>
          <textarea id="notes" placeholder="- 파동: (1)-(2)-(3)-(4)-(5) 후보
- 조정: A-B-C 시나리오
- 지지: 63.2k / 60.8k, 저항: 68.5k
- 무효화: 59.9k 하향 이탈 시
"></textarea>
          <div class="row" style="margin-top:8px">
            <span class="note">심볼마다 자동 저장됩니다 (로컬 저장, 브라우저에만 보관).</span>
            <button class="btn" id="clear-btn">현재 심볼 메모 초기화</button>
          </div>
        </div>
      </div>
    </div>

    <!-- 간단 체크리스트 -->
    <div class="card" style="margin-top:12px">
      <h3>체크리스트</h3>
      <div class="pad">
        <ul>
          <li>상위 타임프레임 추세(주/일) → 하위 타임프레임(4H/1H) 정합성 확인</li>
          <li>파동 구조 충돌 여부(확장/단축, 겹침 판단)</li>
          <li>거래량/모멘텀(다이버전스) 확인</li>
          <li>리스크 한도와 무효화 레벨 명확화</li>
        </ul>
      </div>
    </div>

    <footer>© <span id="y"></span> Elliott Wave · 개인 학습/연구용</footer>
  </div>

  <!-- TradingView 스크립트 -->
  <script src="https://s3.tradingview.com/tv.js"></script>
  <script>
    // 연도 표기
    document.getElementById('y').textContent = new Date().getFullYear();

    // 상단 티커
    new TradingView.widget({
      "container_id": "ticker-tape",
      "width": "100%",
      "height": 46,
      "symbols": [
        {"proName": "BINANCE:BTCUSDT", "title": "BTC/USDT"},
        {"proName": "BINANCE:ETHUSDT", "title": "ETH/USDT"},
        {"proName": "BINANCE:SOLUSDT", "title": "SOL/USDT"},
        {"proName": "BINANCE:XRPUSDT", "title": "XRP/USDT"},
        {"proName": "BINANCE:SUIUSDT", "title": "SUI/USDT"}
      ],
      "colorTheme": "dark",
      "isTransparent": true,
      "displayMode": "adaptive",
      "locale": "kr"
    });

    // 차트 위젯 생성 함수
    let tvWidget = null;
    function loadChart(symbol) {
      // 타이틀 업데이트
      const title = document.getElementById('chart-title');
      title.textContent = '차트 · ' + symbol.split(':')[1];

      // 컨테이너 비우고 다시 생성
      const container = document.getElementById('tv-chart');
      container.innerHTML = '';
      tvWidget = new TradingView.widget({
        "container_id": "tv-chart",
        "autosize": true,
        "symbol": symbol,
        "interval": "60",
        "timezone": "Asia/Seoul",
        "theme": "dark",
        "style": "1",
        "locale": "kr",
        "toolbar_bg": "#0b0f14",
        "enable_publishing": false,
        "withdateranges": true,
        "allow_symbol_change": false,
        "studies": [
          "STD;Relative Strength Index",
          "STD;Moving Average",
          "STD;Moving Average@tv-basicstudies-2"
        ],
        "details": true,
        "hotlist": false,
        "calendar": false
      });

      // 메모 로드
      const key = 'notes:' + symbol;
      document.getElementById('notes').value = localStorage.getItem(key) || '';
      document.getElementById('save-btn').onclick = () => {
        localStorage.setItem(key, document.getElementById('notes').value || '');
        alert('저장 완료');
      };
      document.getElementById('clear-btn').onclick = () => {
        if (confirm('현재 심볼 메모를 비울까요?')) {
          localStorage.removeItem(key);
          document.getElementById('notes').value = '';
        }
      };
    }

    // 탭 클릭 처리
    const tabs = document.getElementById('symbol-tabs');
    tabs.addEventListener('click', (e) => {
      const el = e.target.closest('.tab');
      if (!el) return;
      [...tabs.children].forEach(t => t.classList.remove('active'));
      el.classList.add('active');
      loadChart(el.dataset.symbol);
    });

    // 초기 로드 (BTC)
    loadChart('BINANCE:BTCUSDT');
  </script>
</body>
</html>
